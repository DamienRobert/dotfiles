#!/bin/zsh
. $HOME/.initvars

eval $($MYFILES/00COMPUTERS.rb --export=install)
readconfig="$HOME/mine/ruby/lib/dr/readconfig.rb"
MAINT="$HOME/mine/maint"

check_bin() {
	which $@ >/dev/null
}

if check_bin gem; then
	echo "# gem"
	gem update
fi

if [[ -n ${(M)INSTALL:#gems-full} ]]; then
	if check_bin pip2; then
		echo "# pip2"
		pip2 install --user $($readconfig -j $MAINT/gems/pip2) -U
	fi
fi

if [[ -n ${(M)INSTALL:#gems-extra} ]]; then
	if check_bin npm; then
		echo "# npm"
		npm outdated || npm update
	fi
	if check_bin cpanm; then
		echo "# cpanm"
		cpanm $($readconfig -j $MAINT/gems/cpanm)
	fi
fi
